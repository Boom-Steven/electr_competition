# 跳频识别分析算法：

1. 确定分析参数：如频率分辨率100kHz

2. 由频率分辨率计算所需的FFT点数

3. 对输入信号进行STFT分析（采用Blackman窗），对输出的每一帧计算功率谱密度，并进行高斯平滑处理

4. 按时间顺序遍历所有帧，根据信号底噪确定检测阈值，采用峰值检测法检测信号在每一帧出现的频率位置，对在同一位置连续出现的信号，记录其开始时间和持续长度，定义为一个信号段，记录到信号段列表中。

5. 得到所有的信号段后，以信号的开始结束时间、长度作为匹配标准，将长度相近且在时间上连续（一个信号的开始时间接近另一个信号的结束时间）的信号归类为一组，得到n组信号段，将信号段个数过少的组剔除。这样得到的每个信号组都来自同一个发射源。

6. 对于每一个组

   a)   将组内的每段信号出现频率按时间排序得到一个频率序列，通过检测序列的周期长度确定跳频图案的周期，并提取跳频图案和频率集；通过对信号段的开始结束时间和信号段的个数计算出跳频周期，即得出跳频速度。

   b)   对于组内的每段信号，根据其出现的频点进行带通滤波与数字下变频得到基带信号，调用通信信号调制识别算法进行调制方式和符号速率识别，记录所有出现过的调制方式和符号速率。

 

# 通信信号调制识别算法：

1. 对输入基带信号的复包络进行分析，得到复包络幅度方差与平均信号功率的比值![img](file:///C:/Users/ASUS/AppData/Local/Temp/msohtmlclip1/01/clip_image002.png)

2. 对信号进行FFT变换，对其功率谱密度进行分析，将频率最低的几个数字频率对应的功率谱密度相加得到![img](file:///C:/Users/ASUS/AppData/Local/Temp/msohtmlclip1/01/clip_image004.png)，所有频率的功率谱密度总和为![img](file:///C:/Users/ASUS/AppData/Local/Temp/msohtmlclip1/01/clip_image006.png)

3. 根据![img](file:///C:/Users/ASUS/AppData/Local/Temp/msohtmlclip1/01/clip_image002.png)与![img](file:///C:/Users/ASUS/AppData/Local/Temp/msohtmlclip1/01/clip_image008.png)将信号分为AM、频率调制（FM或nFSK或GMSK或MSK）与数字幅度调制三个大类，若![img](file:///C:/Users/ASUS/AppData/Local/Temp/msohtmlclip1/01/clip_image002.png)小于一定阈值，认为信号是频率调制信号，进入第5步；若![img](file:///C:/Users/ASUS/AppData/Local/Temp/msohtmlclip1/01/clip_image008.png)大于一定阈值，认为信号是AM信号，进入第4步；对于其他情况，认为是数字幅度调制信号，进入第6步。

4. 对于AM，直接返回调制类型AM，符号速率为0。

5. 对于频率调制，首先调用主瓣带宽检测算法得到主瓣带宽，然后根据得到的主瓣带宽进行低通滤波，再调用基于包络的符号速率检测算法，检测是否具有符号符号周期。如果有，判定为nFSK/GMSK/MSK，跳至(a)，否则判定为FM。

   a)   若判定为nFSK/GMSK/MSK，对信号进行相位微分得到瞬时频率，经过高斯平滑后统计不同频率出现的概率。基于统计结果进行聚类分析，判定出现的频率个数n，若n>2，则判定为nFSK；若n=2，则根据两个频率的间隔与符号速率判定是否为MSK/GMSK，并且根据频率分布的方差确定是否为GMSK。如果都不是，判定为2FSK。

6. 对于数字幅度调制，首先调用主瓣带宽检测算法得到主瓣带宽，然后根据得到的主瓣带宽确定升余弦滚降滤波器参数，生成升余弦滚降滤波器对信号进行滤波，将滤波后的信号输入基于包络的符号速率检测算法，进行符号速率检测以及符号采样时间同步；并将信号输入载波同步算法，进行载波相位补偿。在符号采样时间上对经过载波同步的信号进行采样，得到每个符号周期上的信号采样点。将所有采样点输入星座图分析算法进行分析，得到数字调制方式。

 

# 星座图分析算法：

1. 算法初始化：生成各种数字调制经过本程序使用的载波同步算法后得到的星座图，并将星座图进行功率归一化，作为参考星座图集。

2. 输入信号采样点集后，将其功率归一化，并映射为星座图中的星座点。将得到的星座点进行二位Gaussian平滑滤波，并进行二位极值检测，以得到星座点集。

3. 将星座点集与每一个参考星座图进行比较（包括参考星座图中的星座点覆盖程度、平均最小差错向量幅度），得出一个评分，代表星座点集属于该参考星座图的似然程度。

4. 确定似然程度最大的参考星座图，作为数字调制方式识别结果。